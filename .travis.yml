language: go

go:
- 1.14.x

before_install:
  - go get github.com/mattn/goveralls

script:
  - $GOPATH/bin/goveralls -service=travis-ci

before_deploy:
  - GOOS=linux go build -o=goproxie-linux
  - GOOS=darwin go build -o=goproxie-mac
  - GOOS=windows go build -o=goproxie-win

deploy:
  provider: releases
  api_key: "GITHUB OAUTH TOKEN"
  file: 
    - goproxie-win
    - goproxie-mac
    - goproxie-linux
  on:
    # TODO Remove when tested
    branch: feat/travis-deploy
    # TODO Uncomment when tested
    # tags: true
  # skip_cleanup: true
  overwrite: true
  # TODO Uncomment when deploys are stable
  draft: true
